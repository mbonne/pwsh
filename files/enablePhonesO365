Must use Azure PowerShell and then run -  Import-Module SkypeOnlineConnector

Import-Csv "C:\TDC-testrun.csv" |  ForEach {Set-CsUser -Identity $_.Identity -EnterpriseVoiceEnabled $true -HostedVoiceMail $true -OnPremLineURI $_.OnPremLineURI}

Import-Csv "C:\TDC-testrun.csv" |  ForEach {Grant-CsOnlineVoiceRoutingPolicy -Identity $_.Identity -PolicyName Australia}

Import-Csv "C:\TDC.csv" |  ForEach {Get-CsOnlineUser -Identity $_.Identity | Format-List -Property FirstName, LastName, EnterpriseVoiceEnabled, HostedVoiceMail, LineURI, UsageLocation, UserPrincipalName, WindowsEmailAddress, SipAddress, OnPremLineURI, OnlineVoiceRoutingPolicy, TeamsCallingPolicy, dialplan, TeamsInteropPolicy}


Import-Csv "C:\TDC.csv" | ForEach {Set-CsUser -Identity $_.Identity -EnterpriseVoiceEnabled $true -HostedVoiceMail $true -OnPremLineURI $_.OnPremLineURI} | ForEach {Grant-CsOnlineVoiceRoutingPolicy -Identity $_.Identity -PolicyName Australia} | ForEach {Get-CsOnlineUser -Identity $_.Identity | Format-List -Property FirstName, LastName, EnterpriseVoiceEnabled, HostedVoiceMail, LineURI, UsageLocation, UserPrincipalName, WindowsEmailAddress, SipAddress, OnPremLineURI, OnlineVoiceRoutingPolicy, TeamsCallingPolicy, dialplan, TeamsInteropPolicy}


------------------------------------------------------------------------------------------------
https://support.switchconnect.com.au/portal/kb/articles/activating-users-for-direct-routing

SAMPLE CSV CONTENTS BELOW

Identity,OnPremLineURI
alex.rendell@tdc.com.au,tel:+61283322112
andrew.rollisson@tdc.com.au,tel:+61283322113
anthony@tdc.com.au,tel:+61283322110


----

Guide found here: https://support.switchconnect.com.au/portal/kb/articles/activating-users-for-direct-routing


Must use Azure PowerShell from within Windows 10 - and then run -  Import-Module SkypeOnlineConnector
before connecting to the Office365 tenancy with global admin account.

## Provisioning: Configure SIP Trunk PowerShell Commands
Import-Module SkypeOnlineConnector

## Then connect to O365
$cred = Get-Credential
$session = New-CsOnlineSession -Credential $cred -verbose
Import-PSSession $session

## Enable Voice for User and assign Number
Set-CsUser -Identity alex.rendell@tdc.com.au -EnterpriseVoiceEnabled $true -HostedVoiceMail $true -OnPremLineURI tel:+61735329401

## Assign Voice Route to User
Grant-CsOnlineVoiceRoutingPolicy -Identity “alex.rendell@tdc.com.au" -PolicyName Australia

## Verify all Settings are correct
Get-CsOnlineUser -Identity “alex.rendell@tdc.com.au" | Format-List -Property FirstName, LastName, EnterpriseVoiceEnabled, HostedVoiceMail, LineURI, UsageLocation, UserPrincipalName, WindowsEmailAddress, SipAddress, OnPremLineURI, OnlineVoiceRoutingPolicy, TeamsCallingPolicy, dialplan, TeamsInteropPolicy
## Examples below are using the TDC deployment to illustrate.
Import-Csv "C:\TDC-testrun.csv" |  ForEach {Set-CsUser -Identity $_.Identity -EnterpriseVoiceEnabled $true -HostedVoiceMail $true -OnPremLineURI $_.OnPremLineURI}
##
Import-Csv "C:\TDC-testrun.csv" |  ForEach {Grant-CsOnlineVoiceRoutingPolicy -Identity $_.Identity -PolicyName Australia}
##
Import-Csv "C:\TDC.csv" |  ForEach {Get-CsOnlineUser -Identity $_.Identity | Format-List -Property FirstName, LastName, EnterpriseVoiceEnabled, HostedVoiceMail, LineURI, UsageLocation, UserPrincipalName, WindowsEmailAddress, SipAddress, OnPremLineURI, OnlineVoiceRoutingPolicy, TeamsCallingPolicy, dialplan, TeamsInteropPolicy}
##
## Or as a one liner (This is Importing .csv and applying the number to email account on the same row/line - Verify the settings as a second command when done)
Import-Csv "C:\TDC.csv" | ForEach {Set-CsUser -Identity $_.Identity -EnterpriseVoiceEnabled $true -HostedVoiceMail $true -OnPremLineURI $_.OnPremLineURI} | ForEach {Grant-CsOnlineVoiceRoutingPolicy -Identity $_.Identity -PolicyName Australia}
##
Import-Csv "C:\TDC.csv" |  ForEach {Get-CsOnlineUser -Identity $_.Identity | Format-List -Property FirstName, LastName, EnterpriseVoiceEnabled, HostedVoiceMail, LineURI, UsageLocation, UserPrincipalName, WindowsEmailAddress, SipAddress, OnPremLineURI, OnlineVoiceRoutingPolicy, TeamsCallingPolicy, dialplan, TeamsInteropPolicy}
##

------------------------------------------------------------------------------------------------
SAMPLE CSV CONTENTS BELOW
Identity,OnPremLineURI
alex.rendell@tdc.com.au,tel:+61283322112
andrew.rollisson@tdc.com.au,tel:+61283322113
anthony@tdc.com.au,tel:+61283322110

A Note about using Variables in Powershell to reference columns in the .csv
When defining the Variable within the command you use the $_. before the column name as the variable. Make sure it is exactly the same as the column header.
Then foreach will iterate down the list of .csv rows to loop the command
